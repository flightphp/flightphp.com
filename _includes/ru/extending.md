# Расширяемость

Flight изначально разработан, как расширяемый фреймворк. Он поставляется с базовым набором методов и компонентов, но легко позволяет добавлять свои собственные методы, регистрировать собственные классы, или даже переопределять существующие классы и методы фреймворка.

## Добавление собственных методов

Для добавления своего метода во фреймворк используется метод `map`:

``` php?start_inline=1
// Определите метод
Flight::map('hello', function($name){
    echo "hello $name!";
});

// Вызовите метод
Flight::hello('Bob');
```

## Регистрация собственных классов

Для регистрации класса, используйте метод `register`:

``` php?start_inline=1
// Регистрация класса
Flight::register('user', 'User');

// Получение экземпляра класса
$user = Flight::user();
```

Метод `register` позволяет так же передавать параметры в конструктор регистрируемого класса. Поэтому когда вы запрашиваете класс, он уже будет предварительно инициализирован. Вы можете определить параметры конструктора передав массив с ними в качестве третьего аргумента методу `register`. Вот пример создания подключения к базе данных:

``` php?start_inline=1
// Регистрация класса с параметрами конструктора
Flight::register('db', 'PDO', array('mysql:host=localhost;dbname=test','user','pass'));

// Получение экземпляра класса
// Вернет инициализированный объект с параметрами переданными при регистрации
//
//     new PDO('mysql:host=localhost;dbname=test','user','pass');
//
$db = Flight::db();
```

Если передать в качестве дополнительного параметра функцию, она будет немедленно выполнена
после создания экземпляра нового объекта. Это позволяет выполнять действия с только что созданными экземпляром класса. Функция принимает один параметр, экземпляр нового объекта.

``` php?start_inline=1
// Функция будет примненеа к только что созданному объекту
Flight::register('db', 'PDO', array('mysql:host=localhost;dbname=test','user','pass'),
  function($db){
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
  }
);
```

По умолчанию, каждый раз, когда вы запрашиваете свой класс, вы получите один и тот же экземпляр. Чтобы получить новый экземпляр объекта, достаточно передать `false` в качестве параметра метода:

``` php?start_inline=1
// Общий экземпляр 
$shared = Flight::db();

// Новый экземпляр объекта
$new = Flight::db(false);
```

Имейте в виду, что добавленные методы имеют приоритет перед зарегистрированными классами. Если вы объявите одинаковые метод и класс, то будет вызван только метод.