# Расширяемость

Так как Flight изначально разрабатывался с упором на расширяемость, он позволяет легко расширять фреймворк
собственными методами и классами, а также, переопределять существующие базовые методы и классы.

## Добавление методов

Для добавления своего метода во фреймворк используется метод `map`:

``` php?start_inline=1
// Определение метода
Flight::map('hello', function($name){
    echo "hello $name!";
});

// Вызов метода
Flight::hello('Bob');
```

## Регистрация классов

Для регистрации класса, используйте метод `register`:

``` php?start_inline=1
// Регистрация класса
Flight::register('user', 'User');

// Получение экземпляра класса
$user = Flight::user();
```

Метод `register` позволяет передавать параметры в конструктор регистрируемого класса.
Поэтому когда вы запрашиваете класс, он уже будет предварительно инициализирован.
Вы можете определить параметры конструктора передав массив с ними в качестве третьего аргумента методу `register`.

Пример создания подключения к базе данных:

``` php?start_inline=1
// Регистрация класса с параметрами конструктора
Flight::register('db', 'PDO', array('mysql:host=localhost;dbname=test','user','pass'));

// Получение экземпляра класса
// Вернет инициализированный объект с параметрами переданными при регистрации
//
//     new PDO('mysql:host=localhost;dbname=test','user','pass');
//
$db = Flight::db();
```

Если передать в качестве дополнительного параметра функцию, она будет выполнена сразу же после создания
экземпляра нового объекта. Это позволяет выполнять действия с только что созданными экземпляром класса.
Функция принимает один параметр, экземпляр нового объекта.

``` php?start_inline=1
// Функция будет примненена к только что созданному объекту
Flight::register('db', 'PDO', array('mysql:host=localhost;dbname=test','user','pass'),
  function($db){
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
  }
);
```

По умолчанию, каждый раз, когда вы запрашиваете свой класс, вы получите один и тот же экземпляр. 
Чтобы получить новый экземпляр объекта, достаточно передать `false` в качестве параметра метода:

``` php?start_inline=1
// Общий экземпляр
$shared = Flight::db();

// Новый экземпляр объекта
$new = Flight::db(false);
```

Имейте в виду, что добавленные методы имеют приоритет перед зарегистрированными классами. Если вы объявите одинаковые метод и класс, то будет вызван только метод.
